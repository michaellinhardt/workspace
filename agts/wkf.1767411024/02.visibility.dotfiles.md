# Sketchybar Visibility Analysis - CriticalElement/dotfiles

## Summary

**Repository**: https://github.com/CriticalElement/dotfiles
**Finding**: This configuration does NOT implement true "only visible when items to show" behavior. The bar is always visible but uses transparency and item-based visual design.

---

## Bar Visibility Settings Found

### Main Bar Configuration

```bash
sketchybar --bar height=54 \
                 margin=12 \
                 y_offset=0 \
                 padding_left=0 \
                 padding_right=0 \
                 color=0x00000000
```

**Key observation**: `color=0x00000000` makes the bar itself **completely transparent**. This creates the illusion that only items are visible, when in fact the bar is always present but invisible.

### No Auto-Hide Settings

The configuration does **not** include:
- `autohide=on` or `autohide=off`
- `notch_width` settings
- Visibility toggle commands
- Show/hide event triggers

---

## How Visual "Only Items Visible" Effect is Achieved

### 1. Transparent Bar Background
```bash
color=0x00000000  # Fully transparent bar
```

### 2. Individual Item Backgrounds
Each item has its own opaque background, making only items visible:
```bash
sketchybar --default updates=when_shown \
                     background.color=0x00000000 \
                     background.border_width=1 \
                     background.corner_radius=15 \
                     background.height=30
```

### 3. Color-Coded Item Containers
Items use distinct background colors:
```bash
BLUE="0xFF7FBBB3"
ORANGE="0xFFE69875"
PINK="0xFFD699B6"
RED="0xFFE67E80"
GREEN="0xFFA7C080"
```

Example item with colored background:
```bash
sketchybar --add item time right \
           --set time update_freq=1 \
                      script="$PLUGIN_DIR/time.sh" \
                      icon.color=0xFF000000 \
                      icon=ó±‘Ž \
                      label.color=0xFF000000 \
                      background.color=$BLUE \
                      background.border_color=$BLUE
```

---

## Animation Effects (title.sh)

The title display uses y_offset animation for visual effects:
```bash
# Creates sliding animation effect using y_offset
# y_offset values: 70, 7, 0 (animates from off-screen to position)
sketchybar --animate circ 15 --set title y_offset=0
```

---

## Space Highlighting (highlight_space.sh)

Dynamic positioning for workspace indicator:
```bash
sketchybar --animate circ 15 \
           --set highlight_space background.padding_left=$((-(LENGTH - (SID - 2)) * 30 + 7))
```

---

## Yabai Integration for Updates

From `yabairc`:
```bash
yabai -m signal --add event=application_front_switched \
                action="sketchybar --trigger title_change"
```

---

## How to Reproduce "Only Visible Items" Effect

### Option 1: Transparent Bar (Current Approach)
```bash
# Make bar background fully transparent
sketchybar --bar color=0x00000000

# Give each item its own visible background
sketchybar --set item_name background.color=0xFF7FBBB3 \
                           background.corner_radius=15
```

### Option 2: True Auto-Hide (Not Used Here)
For actual show/hide behavior, sketchybar supports:
```bash
# Auto-hide when no items need display
sketchybar --bar autohide=on

# Or toggle visibility programmatically
sketchybar --bar hidden=on
sketchybar --bar hidden=off
```

---

## Conclusion

The CriticalElement dotfiles achieve a "floating items" visual effect through:

1. **Fully transparent bar** (`color=0x00000000`)
2. **Individual item backgrounds** with colors and corner radius
3. **Blur effects** on items (`background.blur_radius=2`)
4. **Animation** using y_offset and padding for dynamic effects

This is a **visual design pattern**, not a true visibility toggle. The bar itself remains present and occupies screen space, but its transparency makes only the styled items appear visible.

---

## Configuration Files Reference

| File | Purpose |
|------|---------|
| `.config/sketchybar/sketchybarrc` | Main configuration (167 lines) |
| `.config/sketchybar/scripts/title.sh` | Title animation logic |
| `.config/sketchybar/scripts/highlight_space.sh` | Workspace indicator positioning |
| `.config/yabai/yabairc` | Event triggers for sketchybar updates |
